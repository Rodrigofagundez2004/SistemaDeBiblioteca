<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Sistema Biblioteca</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
  </head>
  <body>
    <header class="topbar">
      <div class="logo">ğŸ“š Sistema de Salas</div>
      <nav class="nav-links">
        <a href="/" class="nav-item active">ğŸ  Inicio</a>
        <a href="/participantes" class="nav-item">ğŸ‘¥ Participantes</a>
        <a href="/salas" class="nav-item">ğŸšª Salas</a>
        <a href="/reservas" class="nav-item">ğŸ“… Reservas</a>
        
        <!-- ğŸ‘‡ NUEVO: InformaciÃ³n del usuario -->
        {% if session.usuario %}
          <div class="user-info">
            <span class="user-name">ğŸ‘‹ {{ session.usuario.nombre }} {{ session.usuario.apellido }}</span>
            <a href="/auth/logout" class="nav-item logout-btn">ğŸšª Cerrar sesiÃ³n</a>
          </div>
        {% else %}
          <a href="/auth/login" class="nav-item login-btn">ğŸ” Iniciar sesiÃ³n</a>
        {% endif %}
      </nav>
    </header>

    <main class="container">
      <!-- ğŸ‘‡ NUEVO: Mensaje de bienvenida/recordatorio de login -->
      {% if session.usuario %}
        <div class="welcome-banner">
          <div class="welcome-content">
            <h3>Â¡Bienvenido, {{ session.usuario.nombre }}! ğŸ‰</h3>
            <p>EstÃ¡s logueado como <strong>{{ session.usuario.ci }}</strong>. Ahora puedes gestionar reservas y acceder a todas las funciones del sistema.</p>
          </div>
        </div>
      {% else %}
        <div class="login-reminder">
          <div class="reminder-content">
            <h3>ğŸ” Acceso al sistema</h3>
            <p>Para gestionar reservas y acceder a todas las funciones, <a href="/auth/login">iniciÃ¡ sesiÃ³n</a> o <a href="/auth/registro">creÃ¡ una cuenta</a>.</p>
          </div>
        </div>
      {% endif %}

      <section class="hero-card">
        <h1>ğŸ« Sistema de GestiÃ³n de Salas</h1>
        <p>
          AdministrÃ¡ participantes, salas y reservas de forma sencilla. Usando
          una base de datos en Azure y una API en Flask.
        </p>
        <div class="hero-actions">
          <a href="/reservas" class="btn primary">Crear nueva reserva</a>
          <a href="/participantes" class="btn secondary">Ver participantes</a>
          
          <!-- ğŸ‘‡ NUEVO: BotÃ³n extra para usuarios logueados -->
          {% if session.usuario %}
            <a href="/auth/logout" class="btn outline">Cerrar sesiÃ³n</a>
          {% else %}
            <a href="/auth/login" class="btn outline">Iniciar sesiÃ³n</a>
          {% endif %}
        </div>
      </section>

      <!-- ğŸ‘‡ NUEVO: SecciÃ³n de estado del sistema -->
      <section class="status-cards">
        <div class="status-card">
          <h3>ğŸ“Š Estado del sistema</h3>
          <div class="status-info">
            {% if session.usuario %}
              <p><strong>Usuario:</strong> {{ session.usuario.nombre }} {{ session.usuario.apellido }}</p>
              <p><strong>Email:</strong> {{ session.usuario.email }}</p>
              <p><strong>CÃ©dula:</strong> {{ session.usuario.ci }}</p>
              <p><strong>Estado:</strong> <span class="status-online">âœ… Conectado</span></p>
            {% else %}
              <p><strong>Estado:</strong> <span class="status-offline">âŒ No logueado</span></p>
              <p>IniciÃ¡ sesiÃ³n para acceder a todas las funciones del sistema.</p>
            {% endif %}
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <span>Proyecto Obligatorio Â· Segundo Semestre 2025</span>
      {% if session.usuario %}
        <span class="user-session">SesiÃ³n activa: {{ session.usuario.email }}</span>
      {% endif %}
    </footer>
  </body>
</html>